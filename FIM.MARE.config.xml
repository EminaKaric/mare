<?xml version="1.0" encoding="utf-8" ?>
<Rules xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ExternalFiles>
    <XmlFile Name="CountryCodes" Path="C:\temp\CountryCodes.xml" />
  </ExternalFiles>
  <ManagementAgent Name="inceptio.local">
    <FlowRule Name="AccountName" Direction="Export" xsi:type="FlowRule">
      <Conditions Operator="Or">
        <Condition xsi:type="ObjectClassMatch" Source="CSEntry" Target="MVEntry" Pattern="^group" />
        <Condition xsi:type="SubCondition" Operator="And">
          <Condition xsi:type="SourceValueMatch" Source="MVEntry" AttributeName="givenName" Pattern="^Risto|Robert$" />
          <Condition xsi:type="SourceValueMatch" Source="MVEntry" AttributeName="sn" Pattern="^Petersen$" />
        </Condition>
      </Conditions>
      <SourceExpression>
        <Source Name="AccountName" xsi:type="Attribute">
          <Transforms>
            <Transform xsi:type="ToUpper"/>
          </Transforms>
        </Source>
      </SourceExpression>
      <Target Name="sAMAccountName" ActionOnNullSource="None" />
    </FlowRule>

    <FlowRule Name="AccountSidToString" Direction="Import" xsi:type="FlowRule">
      <SourceExpression>
        <Source Name="objectSid" xsi:type="Attribute">
          <Transforms>
            <Transform xsi:type="SIDToString" SIDType="AccountSid" />
          </Transforms>
        </Source>
      </SourceExpression>
      <Target Name="objectSidAsString" ActionOnNullSource="Delete" />
    </FlowRule>

    <FlowRule Name="GUIDToString" Direction="Import" xsi:type="FlowRule">
      <SourceExpression>
        <Source Name="objectGUID" xsi:type="Attribute">
          <Transforms>
            <Transform xsi:type="Base64ToGUID" />
          </Transforms>
        </Source>
      </SourceExpression>
      <Target Name="objectGuidAsString" ActionOnNullSource="Delete" />
    </FlowRule>

    <FlowRule Name="LastLogonTime" Direction="Import" xsi:type="FlowRule">
      <SourceExpression>
        <Source Name="lastLogonTimeStamp" xsi:type="Attribute">
          <Transforms>
            <Transform xsi:type="FormatDate" DateType="FileTimeUTC" ToFormat="yyyy-MM-dd hh:MM:ss"/>
          </Transforms>
        </Source>
      </SourceExpression>
      <Target Name="lastLogonTime" ActionOnNullSource="Delete" />
    </FlowRule>

    <FlowRule Name="IsActive" Direction="Import" xsi:type="FlowRule">
      <SourceExpression>
        <Source Name="userAccountControl" xsi:type="Attribute">
          <Transforms>
            <Transform xsi:type="IsBitNotSet" BitPosition="1"/>
          </Transforms>
        </Source>
      </SourceExpression>
      <Target Name="isActive" ActionOnNullSource="Delete" />
    </FlowRule>

    <FlowRule Name="IsActiveText" Direction="Import" xsi:type="FlowRule">
      <SourceExpression>
        <Source Name="userAccountControl" xsi:type="Attribute"/>
      </SourceExpression>
      <Target Name="isActiveText" ActionOnNullSource="Delete">
        <Transforms>
          <Transform xsi:type="IsBitSet" BitPosition="1"/>
          <Transform xsi:type="Replace" OldValue="True" NewValue="Inactive"/>
          <Transform xsi:type="Replace" OldValue="False" NewValue="Active"/>
        </Transforms>
      </Target>
    </FlowRule>
  </ManagementAgent>
</Rules>

<!--<CustomDLL>sample.custom.rulesextension.dll</CustomDLL>-->
<!--<FlowRule Name="City" Direction="Import" xsi:type="FlowRuleCode"/>-->
<!--<FlowRule Name="ObjectGuidToString" Direction="Import" xsi:type="FlowRuleGUIDToString">
      <Source xsi:type="Attribute" Name="objectGUID"/>
      <Target xsi:type="Attribute" Name="objectGuidAsString"/>
    </FlowRule>-->
<!--<FlowRule Name="ObjectSidToString" Direction="Import" xsi:type="FlowRuleSIDToString">
      <Source xsi:type="Attribute" Name="objectSid"/>
      <Target xsi:type="Attribute" Name="objectSidAsString"/>
    </FlowRule>-->
<!--<FlowRule Name="DisplayName" Direction="Import" xsi:type="FlowRuleConcatenateString">
      <SourceExpression>
        <Source xsi:type="Attribute" Name="givenName" ConvertToUppercase="true" Trim="false" />
        <Source xsi:type="Constant" Value=" "/>
        <Source xsi:type="Attribute" Name="sn"/>
      </SourceExpression>
      <Target xsi:type="Attribute" Name="description"/>
    </FlowRule>-->
<!--<FlowRule Name="Company" Direction="Export" xsi:type="FlowRuleConcatenateString">
      <SourceExpression>
        <Source xsi:type="Constant" Value="Goverco"/>
        <Source xsi:type="Constant" Value="ApS"/>
      </SourceExpression>
      <Target xsi:type="Attribute" Name="Company"/>
    </FlowRule>-->
<!--<FlowRule Name="lastLogonTimeStamp" Direction="Import" xsi:type="FlowRuleConvertFromFileTimeUtc">
      <Source Name="lastLogonTimeStamp"/>
      <Target Name="adLastLoginTimeStamp" ActionOnNullSource="Delete" DateFormat="yyyy-MM-ddThh:mm:ss.000"/>
    </FlowRule>-->
<!--<FlowRule Name="PasswordLastSet" Direction="Import" xsi:type="FlowRuleConvertFromFileTimeUtc">
      <Source Name="pwdLastSet"/>
      <Target Name="adPasswordLastSet" ActionOnNullSource="Delete" DateFormat="yyyy-MM-ddThh:mm:ss"/>
    </FlowRule>-->


<!--<FlowRule Name="UACAsString" Direction="Import" xsi:type="FlowRuleToString">
      <Source Name="displayName">
        <Transforms>
          <Transform xsi:type="ToUpper"/>
          <Transform xsi:type="ToLower"/>
        </Transforms>
      </Source>
      <Target Name="description" ActionOnNullSource="SetDefault" />
    </FlowRule>

    <FlowRule Name="UACAsString" Direction="Export" xsi:type="FlowRuleToString">
      <Source Name="displayName">
        <Transforms>
          <Transform xsi:type="Trim"/>
          <Transform xsi:type="TrimEnd"/>
          <Transform xsi:type="TrimStart"/>
          <Transform xsi:type="ToUpper"/>
          <Transform xsi:type="ToLower"/>
          <Transform xsi:type="RegexReplace" Pattern=" " Replacement=""/>
          <Transform xsi:type="Substring" StartIndex="1" Length="5"/>
          <Transform xsi:type="Replace" OldValue="tis" NewValue="Pis"/>
          <Transform xsi:type="PadLeft" TotalWidth="8" PaddingChar="#"/>
          <Transform xsi:type="PadRight" TotalWidth="8" PaddingChar="#"/>
        </Transforms>
      </Source>
      <Target Name="description" ActionOnNullSource="Delete" />
    </FlowRule>-->

<!--<FlowRule Name="SIPEnabled" Direction="Import" xsi:type="FlowRuleToString">
      <Source Name="msRTCSIP-UserEnabled"/>
      <Target Name="isSIPEnabledAsString" ActionOnNullSource="Delete" />
    </FlowRule>-->

